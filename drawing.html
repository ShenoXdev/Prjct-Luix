<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mini Animation Studio</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #1e1e1e;
      color: #f1f1f1;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    header {
      background: #252526;
      padding: 10px;
      text-align: center;
      font-size: 20px;
      font-weight: bold;
      border-bottom: 2px solid #444;
    }

    #toolbar {
      background: #2d2d30;
      display: flex;
      padding: 8px;
      gap: 10px;
      border-bottom: 2px solid #444;
    }

    button, input, select {
      background: #3a3a3d;
      color: #f1f1f1;
      border: none;
      padding: 6px 10px;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background: #505053;
    }

    #canvasContainer {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #1e1e1e;
    }

    canvas {
      background: #fff;
      border: 2px solid #444;
      border-radius: 10px;
    }

    footer {
      background: #252526;
      text-align: center;
      padding: 6px;
      font-size: 12px;
      border-top: 2px solid #444;
    }
  </style>
</head>
<body>
  <header>🎨 Mini Animation Studio</header>

  <div id="toolbar">
    <button onclick="setTool('brush')">🖌 Brush</button>
    <button onclick="setTool('line')">📏 Line</button>
    <button onclick="setTool('circle')">⚪ Circle</button>
    <button onclick="setTool('rect')">⬛ Rect</button>
    <button onclick="setTool('eraser')">🧽 Eraser</button>
    <input type="color" id="colorPicker" value="#000000">
    <input type="number" id="sizePicker" value="5" min="1" max="100">
    <button onclick="undo()">↩ Undo</button>
    <button onclick="redo()">↪ Redo</button>
    <button onclick="saveProject()">💾 Save</button>
    <button onclick="loadProject()">📂 Load</button>
    <button onclick="exportPNG()">🖼 Export PNG</button>
  </div>

  <div id="canvasContainer">
    <canvas id="drawingCanvas" width="800" height="500"></canvas>
  </div>

  <footer>© 2025 Mini Animation Studio</footer>

  <script>
    const canvas = document.getElementById("drawingCanvas");
    const ctx = canvas.getContext("2d");
    let drawing = false;
    let tool = "brush";
    let color = document.getElementById("colorPicker").value;
    let size = parseInt(document.getElementById("sizePicker").value);
    let startX, startY;
    let history = [];
    let redoStack = [];

    function setTool(t) { tool = t; }
    document.getElementById("colorPicker").oninput = e => color = e.target.value;
    document.getElementById("sizePicker").oninput = e => size = parseInt(e.target.value);

    function saveState() {
      history.push(canvas.toDataURL());
      redoStack = [];
    }

    function undo() {
      if (history.length > 0) {
        redoStack.push(canvas.toDataURL());
        let last = history.pop();
        let img = new Image();
        img.src = last;
        img.onload = () => ctx.drawImage(img, 0, 0);
      }
    }

    function redo() {
      if (redoStack.length > 0) {
        history.push(canvas.toDataURL());
        let next = redoStack.pop();
        let img = new Image();
        img.src = next;
        img.onload = () => ctx.drawImage(img, 0, 0);
      }
    }

    canvas.addEventListener("mousedown", e => {
      drawing = true;
      startX = e.offsetX;
      startY = e.offsetY;
      saveState();
    });

    canvas.addEventListener("mouseup", e => {
      drawing = false;
      if (tool !== "brush" && tool !== "eraser") drawShape(e.offsetX, e.offsetY);
    });

    canvas.addEventListener("mousemove", e => {
      if (!drawing) return;
      if (tool === "brush") {
        ctx.strokeStyle = color;
        ctx.lineWidth = size;
        ctx.lineCap = "round";
        ctx.lineTo(e.offsetX, e.offsetY);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(e.offsetX, e.offsetY);
      } else if (tool === "eraser") {
        ctx.clearRect(e.offsetX - size/2, e.offsetY - size/2, size, size);
      }
    });

    function drawShape(x, y) {
      ctx.strokeStyle = color;
      ctx.lineWidth = size;
      if (tool === "line") {
        ctx.beginPath();
        ctx.moveTo(startX, startY);
        ctx.lineTo(x, y);
        ctx.stroke();
      } else if (tool === "circle") {
        let r = Math.sqrt((x - startX)**2 + (y - startY)**2);
        ctx.beginPath();
        ctx.arc(startX, startY, r, 0, Math.PI * 2);
        ctx.stroke();
      } else if (tool === "rect") {
        ctx.strokeRect(startX, startY, x - startX, y - startY);
      }
    }

    function saveProject() {
      let data = canvas.toDataURL();
      localStorage.setItem("drawingProject", data);
      alert("Project saved!");
    }

    function loadProject() {
      let data = localStorage.getItem("drawingProject");
      if (data) {
        let img = new Image();
        img.src = data;
        img.onload = () => ctx.drawImage(img, 0, 0);
      } else {
        alert("No project found.");
      }
    }

    function exportPNG() {
      let link = document.createElement("a");
      link.download = "drawing.png";
      link.href = canvas.toDataURL();
      link.click();
    }
  </script>
</body>
</html>
